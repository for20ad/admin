
<?php
    helper(['owens','owens_form', 'owens_url']);
    $view_datas = $owensView->getViewDatas();

    $sQUERY_STRING = (empty($_SERVER['QUERY_STRING']) === true) ? '' : '?' . $_SERVER['QUERY_STRING'];
    $sQUERY_STRING = _add_query_string($sQUERY_STRING, _elm($view_datas, 'query_string', []));

    $aLists        = _elm($view_datas, 'lists', []);
    $aPayMethods   = _elm($view_datas, 'aPayMethodConf', []);
    $aOrderStatus  = _elm($view_datas, 'aOrderConf', []);
    $row           = _elm($view_datas, 'row', []);
    $total_rows    = _elm($view_datas, 'total_rows', []);

    $claimStatus =[
        'REQUESTED'                                 => '등록',
        'PROCESSING'                                => '처리중',
        'COMPLETED'                                 => '완료',
        'REJECTED'                                  => '반려',
        'CANCELED'                                  => '취소완료',
        'AUTO_COMPLETED'                            => '자동취소완료'
    ];

    $claimStatusView = [
        'REQUESTED',
        'PROCESSING',
        'CANCELED',
        'AUTO_COMPLETED',
    ];

    // $beforePayment = [
    //     'Created'                                   => '주문 생성',
    //     'PayFailed'                                 => '결제 실패',
    //     'PayChecking'                               => '입금 확인 중',
    //     'PayWaiting'                                => '결제 대기',

    // ];

    // $beforePayComplete = [
    //     'PayChecking'                               => '입금 확인 중',
    //     'PayWaiting'                                => '결제 대기',
    //     'PayComplete'                               => '결제 완료',
    //     'UnpaidCancelComplete'                      => '미입금 취소 완료',
    //     'PrePayCancelComplate'                      => '입금 전 취소',
    //     'OrderCancelComplete'                       => '판매 취소 완료',
    // ];

    // 결제 완료 상태 버튼들
    $afterPayComplete = [
        'PayComplete'                               => '결제 완료',
        'ProductWaiting'                            => '상품 준비 중 처리',
        'OrderCancelComplete'                       => '판매 취소 완료',
        'ShippingCancelRequest'                     => '배송 취소 요청',
        'ShippingCancelComplete'                    => '배송 취소 완료',
        'RefundWaiting'                             => '환불 예정',
        'RefundComplete'                            => '환불 완료',
        'ReturnPickupRequest'                       => '반품 수거 요청',
    ];

    // 배송 상태 버튼들
    $afterShipping = [
        'ShippingRequest'                           => '배송 요청',
        'ShippingProgress'                          => '배송 진행',
        'ShippingComplete'                          => '배송 완료',
        'ShippingCancelRequest'                     => '배송 취소 요청',
        'ShippingCancelComplete'                    => '배송 취소 완료',

    ];

    // 교환 상태 버튼들
    $afterExchange = [
        'ExchangeRequest'                           => '교환 요청',
        'ExchangePickupRequest'                     => '교환 수거 요청',
        'ExchangeApproved'                          => '교환 승인',
        'ExchangePending'                           => '교환 보류',
        'ExchangeReturning'                         => '교환 반송 중',
        'ExchangeReturnComplete'                    => '교환 반송 완료',
        'ExchangeShippingProgress'                  => '교환 재배송 중',
        'ExchangeShippingComplete'                  => '교환 완료',
        'ExchangeRequestRetract'                    => '교환 요청 철회',
        'ExchangeRejected'                          => '교환 불가',
    ];

    // 반품 상태 버튼들
    $afterReturn = [
        'ReturnRequest'                             => '반품 요청',
        'ReturnPickupRequest'                       => '반품 수거 요청',
        'ReturnApproved'                            => '반품 승인',
        'ReturnPending'                             => '반품 보류',
        'ReturnShippingProgress'                    => '반품 반송 중',
        'ReturnShippingComplete'                    => '반품 반송 완료',
        'ReturnCancelRequest'                       => '반품 결제 취소 예정',
        'ReturnCancelComplete'                      => '반품 결제 취소 완료',
        'ReturnRefundRequest'                       => '반품 환불 요청 대기',
        'ReturnRefundWaiting'                       => '반품 환불 예정',
        'ReturnRefundFailed'                        => '환불 재요청 대기',
        'ReturnRefundComplete'                      => '반품 환불 완료',
    ];

    // 상태 배열에 따른 버튼들 매핑
    $buttonsMapping = [
        // 'beforePayment'                             => $beforePayment,
        // 'beforePay'                                 => $beforePayComplete,
        'afterPay'                                  => $afterPayComplete,
        'afterShipping'                             => $afterShipping,
        'afterExchange'                             => $afterExchange,
        'afterReturn'                               => $afterReturn
    ];


    if (empty($aLists) === false)
    {
        $nLoop = 0;
        foreach ($aLists as $vData)
        {
            $nLoop++;
            $row++;
            $no = $total_rows - $row + 1;
?>
<tr data-idx="<?php echo _elm( $vData , 'O_IDX' )?>"  data-ord-id="<?php echo _elm( $vData, 'O_ORDID' )?>" style="height:36px;">
<td class="body2-c small-font">
        <div class="checkbox checkbox-single">
            <?php
                $setParam = [
                    'name' => 'o_i_idx[]',
                    'id' => 'o_i_idx_',
                    'value' => _elm( $vData , 'O_IDX' ) ,
                    'label' => '',
                    'checked' => false,
                    'extraAttributes' => [
                        'aria-label' => 'Single checkbox One',
                        'class'=>'check-item',
                    ]
                ];
                echo getCheckBox( $setParam );
            ?>
        </div>
    </td>
    <td class="body2-c small-font align-top" style="margin:0.5rem;">
        <div class="form-inline" style="padding-top:1.3rem">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none" onclick="copyToClipboard(this)">
                <path d="M2.67467 11.658C2.47023 11.5415 2.30018 11.373 2.18172 11.1697C2.06325 10.9663 2.00057 10.7353 2 10.5V3.83333C2 3.1 2.6 2.5 3.33333 2.5H10C10.5 2.5 10.772 2.75667 11 3.16667M4.66667 6.94467C4.66667 6.47311 4.85399 6.02087 5.18743 5.68743C5.52087 5.35399 5.97311 5.16667 6.44467 5.16667H12.222C12.4555 5.16667 12.6867 5.21266 12.9024 5.30201C13.1181 5.39136 13.3141 5.52233 13.4792 5.68743C13.6443 5.85253 13.7753 6.04854 13.8647 6.26426C13.954 6.47997 14 6.71118 14 6.94467V12.722C14 12.9555 13.954 13.1867 13.8647 13.4024C13.7753 13.6181 13.6443 13.8141 13.4792 13.9792C13.3141 14.1443 13.1181 14.2753 12.9024 14.3647C12.6867 14.454 12.4555 14.5 12.222 14.5H6.44467C6.21118 14.5 5.97997 14.454 5.76426 14.3647C5.54854 14.2753 5.35253 14.1443 5.18743 13.9792C5.02233 13.8141 4.89136 13.6181 4.80201 13.4024C4.71266 13.1867 4.66667 12.9555 4.66667 12.722V6.94467Z" stroke="#616876" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="ordid"><?php echo _elm( $vData , 'O_ORDID' )?></span>
        </div>
        <div class="form-inline">
            <?php echo _elm( $vData , 'O_ORDER_AT' ) ?>
        </div>
        <div class="form-inline">
            <?php echo _elm( $vData , 'MB_NM' ) ?>
        </div>
        <div class="form-inline">
            (<?php echo _elm( $vData , 'MB_USERID' ) ?> / <?php echo _elm( $vData , 'G_NAME' ) ?> )
        </div>
        <div class="form-inline" style="padding-top:0.8rem">
            <?php
            switch( _elm( $vData , 'O_DEVICE' ) ){
                case 'PC':
                    echo '
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M2 8.66667H14M5.33333 14H10.6667M6.66667 11.3333L6.33333 14M9.33333 11.3333L9.66667 14M2 2.66667C2 2.48986 2.07024 2.32029 2.19526 2.19526C2.32029 2.07024 2.48986 2 2.66667 2H13.3333C13.5101 2 13.6797 2.07024 13.8047 2.19526C13.9298 2.32029 14 2.48986 14 2.66667V10.6667C14 10.8435 13.9298 11.013 13.8047 11.1381C13.6797 11.2631 13.5101 11.3333 13.3333 11.3333H2.66667C2.48986 11.3333 2.32029 11.2631 2.19526 11.1381C2.07024 11.013 2 10.8435 2 10.6667V2.66667Z" stroke="#616876" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg> &nbsp; PC 주문
                    ';
                    break;
                case 'MOBILE':
                    echo '
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M7.33333 2.66667H8.66667M8 11.3333V11.34M4 3.33333C4 2.97971 4.14048 2.64057 4.39052 2.39052C4.64057 2.14048 4.97971 2 5.33333 2H10.6667C11.0203 2 11.3594 2.14048 11.6095 2.39052C11.8595 2.64057 12 2.97971 12 3.33333V12.6667C12 13.0203 11.8595 13.3594 11.6095 13.6095C11.3594 13.8595 11.0203 14 10.6667 14H5.33333C4.97971 14 4.64057 13.8595 4.39052 13.6095C4.14048 13.3594 4 13.0203 4 12.6667V3.33333Z" stroke="#616876" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg> &nbsp; 모바일 주문
                    ';
                    break;
                case 'TABLET':
                    echo '
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M7.33333 2.66667H8.66667M8 11.3333V11.34M4 3.33333C4 2.97971 4.14048 2.64057 4.39052 2.39052C4.64057 2.14048 4.97971 2 5.33333 2H10.6667C11.0203 2 11.3594 2.14048 11.6095 2.39052C11.8595 2.64057 12 2.97971 12 3.33333V12.6667C12 13.0203 11.8595 13.3594 11.6095 13.6095C11.3594 13.8595 11.0203 14 10.6667 14H5.33333C4.97971 14 4.64057 13.8595 4.39052 13.6095C4.14048 13.3594 4 13.0203 4 12.6667V3.33333Z" stroke="#616876" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg> &nbsp; 테블릿 주문
                    ';
                    break;
            }
            ?>

        </div>
    </td>
    <td class="body2-c small-font align-top" style="padding:0.5rem;">
        <div class="info-box-radius" >
            <div class="in-status">
                <?php
                if ( !empty( array_intersect(_elm($vData, 'status'), ['PayChecking', 'PayRequest']) ) ) {
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 입금확인필요 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['PayWaiting']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 결제확인필요 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['RefundFailed']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 환불 재요청 확인 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['RefundRequest']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 환불 요청 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['ShippingRefundRequest']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 배송 환불 요청 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['ShippingRefundFailed']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 배송 환불 재요청 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['ExchangeRequest']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 교환 요청 ';
                }else if( !empty( array_intersect(_elm($vData, 'status'), ['ReturnRequest']) ) ){
                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                    </svg> 반품 요청 ';
                }

                if( empty( _elm( $vData, 'claim' ) ) === false ){
                    if( in_array( _elm( _elm( $vData, 'claim' ), 'status' ), $claimStatusView )  ){
                        echo '<div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M11.9999 1.66992C12.9549 1.66992 13.8449 2.13692 14.3899 2.91692L14.4949 3.07692L22.6089 16.6249C22.8555 17.052 22.9897 17.5347 22.9989 18.0277C23.0081 18.5208 22.8919 19.0081 22.6614 19.4441C22.4309 19.8801 22.0935 20.2504 21.6808 20.5204C21.2682 20.7904 20.7937 20.9513 20.3019 20.9879L20.1069 20.9959H3.88194C3.38965 20.9904 2.90678 20.8602 2.47841 20.6175C2.05005 20.3749 1.69015 20.0276 1.43231 19.6082C1.17447 19.1888 1.0271 18.7109 1.00396 18.2191C0.980808 17.7273 1.08264 17.2377 1.29994 16.7959L1.39894 16.6109L9.50894 3.07292C9.76861 2.64473 10.1342 2.29069 10.5706 2.04494C11.0069 1.79919 11.4992 1.67003 11.9999 1.66992ZM11.9999 10.9999H10.9999L10.8829 11.0069C10.6399 11.0358 10.4159 11.1529 10.2534 11.3359C10.0908 11.5189 10.0011 11.7552 10.0011 11.9999C10.0011 12.2447 10.0908 12.4809 10.2534 12.664C10.4159 12.847 10.6399 12.964 10.8829 12.9929L10.9999 12.9999V15.9999L11.0069 16.1169C11.0333 16.3401 11.134 16.548 11.293 16.7069C11.4519 16.8658 11.6597 16.9666 11.8829 16.9929L11.9999 16.9999H12.9999L13.1169 16.9929C13.3402 16.9666 13.548 16.8658 13.7069 16.7069C13.8659 16.548 13.9666 16.3401 13.9929 16.1169L13.9999 15.9999L13.9929 15.8829C13.969 15.6789 13.8829 15.4872 13.7462 15.3339C13.6095 15.1805 13.4289 15.073 13.2289 15.0259L13.1169 15.0059L12.9999 14.9999V11.9999L12.9929 11.8829C12.9666 11.6597 12.8659 11.4519 12.7069 11.2929C12.548 11.134 12.3402 11.0332 12.1169 11.0069L11.9999 10.9999ZM12.0099 7.99992L11.8829 8.00692C11.6399 8.03583 11.4159 8.15288 11.2534 8.33589C11.0908 8.5189 11.0011 8.75516 11.0011 8.99992C11.0011 9.24468 11.0908 9.48095 11.2534 9.66396C11.4159 9.84697 11.6399 9.96401 11.8829 9.99292L11.9999 9.99992L12.1269 9.99292C12.37 9.96401 12.594 9.84697 12.7565 9.66396C12.9191 9.48095 13.0088 9.24468 13.0088 8.99992C13.0088 8.75516 12.9191 8.5189 12.7565 8.33589C12.594 8.15288 12.37 8.03583 12.1269 8.00692L12.0099 7.99992Z" fill="#F76707"/>
                            </svg>
                        ';
                        if( _elm( _elm( $vData, 'claim' ), 'type' ) === 'RETURN' ){
                            echo ' 클래임 '._elm( $claimStatus,  _elm( _elm( $vData, 'claim' ), 'status' ) ).' ( 반품 )</div>';
                        }
                        else if( _elm( _elm( $vData, 'claim' ), 'type' ) === 'EXCHANGE' ){
                            echo ' 클래임 등록( 교환 )</div>';
                        }
                        else if( _elm( _elm( $vData, 'claim' ), 'type' ) === 'REFUND' ){
                            echo ' 클래임 등록( 환불 )</div>';
                        }
                        else if( _elm( _elm( $vData, 'claim' ), 'type' ) === 'CARD_CANCEL' ){
                            echo ' 클래임 등록( 카드취소 )</div>';
                        }
                        else if( _elm( _elm( $vData, 'claim' ), 'type' ) === 'CANCEL' ){
                            echo ' 클래임 등록( 취소 )</div>';
                        }
                    }
                }
                ?>
            </div>
            <div class="in-delivery">
                <div class="form-inline">
                    <?php echo _elm( _elm( $vData, 'delivery' ), 'O_RCV_INFO');?>
                </div>
                <div class="form-inline">
                    <?php echo _elm( _elm( $vData, 'delivery' ), 'O_ADDRESS');?>
                </div>
                <div class="form-inline">
                    <?php echo _elm( _elm( $vData, 'delivery' ), 'O_SHIP_MSG');?>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between;">
                <div class="form-inline" style="padding-top:1rem;flex: 9;">
                    <div class="form-inline">
                        <?php
                            if( empty( _elm( $vData, 'thumb' ) ) === false ){
                                foreach( _elm( $vData, 'thumb' ) as $thumb ){
                                    echo '<span class="in-thumb"><img src="'.$thumb.'"></span>';
                                }
                            }
                        ?>
                    </div>
                    <?php echo _elm( $vData, 'O_TITLE' )?>
                </div>
                <div class="form-inline" style="padding-top:1rem;flex: 1;margin-left:1rem"  id="toggleButton" >
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" class="toggleIcon" onclick="openPrdBox( this )">
                        <path d="M6 15L12 9L18 15" stroke="#1D273B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>


            </div>
            <?php
                // echo "<pre>";
                // print_r( _elm( $vData, 'goodsInfo' ) );
                // echo "</pre>";
                // 상태별로 상품 정보 출력
                foreach ( _elm( $vData, 'goodsInfo' ) as $status => $goodsList) {

                    // 해당 상태에 맞는 버튼들 배열 선택


                    $currentStatus = $status;

                    $buttonsToShow = [];
                    // if (array_key_exists($currentStatus, $beforePayment)) {
                    //     $buttonsToShow = $beforePayment;
                    // }
                    // if (array_key_exists($currentStatus, $beforePayComplete)) {
                    //     $buttonsToShow = $beforePayComplete;
                    // }
                    if (array_key_exists($currentStatus, $afterPayComplete)) {
                        $buttonsToShow = $afterPayComplete;
                    }
                    if (array_key_exists($currentStatus, $afterShipping)) {
                        $buttonsToShow = $afterShipping;
                    }
                    if (array_key_exists($currentStatus, $afterExchange)) {
                        $buttonsToShow = $afterExchange;
                    }
                    if (array_key_exists($currentStatus,  $afterReturn)) {
                        $buttonsToShow = $afterReturn;
                    }
                ?>
                <div class="prd-box" style="display:none;">
                    <div class="box-status" style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="status-text" style="flex: 1;">
                            <?php echo _elm( $aOrderStatus, $currentStatus )?>
                        </div>
                        <!-- SVG 아이콘을 오른쪽 끝에 추가 -->
                        <div style="flex: 0;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" class="dwondownIcon" onclick="openDropDownLayer( this )">
                                <path d="M11 12C11 12.2652 11.1054 12.5196 11.2929 12.7071C11.4804 12.8946 11.7348 13 12 13C12.2652 13 12.5196 12.8946 12.7071 12.7071C12.8946 12.5196 13 12.2652 13 12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M11 19C11 19.2652 11.1054 19.5196 11.2929 19.7071C11.4804 19.8946 11.7348 20 12 20C12.2652 20 12.5196 19.8946 12.7071 19.7071C12.8946 19.5196 13 19.2652 13 19C13 18.7348 12.8946 18.4804 12.7071 18.2929C12.5196 18.1054 12.2652 18 12 18C11.7348 18 11.4804 18.1054 11.2929 18.2929C11.1054 18.4804 11 18.7348 11 19Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M11 5C11 5.26522 11.1054 5.51957 11.2929 5.70711C11.4804 5.89464 11.7348 6 12 6C12.2652 6 12.5196 5.89464 12.7071 5.70711C12.8946 5.51957 13 5.26522 13 5C13 4.73478 12.8946 4.48043 12.7071 4.29289C12.5196 4.10536 12.2652 4 12 4C11.7348 4 11.4804 4.10536 11.2929 4.29289C11.1054 4.48043 11 4.73478 11 5Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <?php
                            if( empty( $buttonsToShow ) === false ){
                            ?>
                            <div class="dropdown" style="display: none;">
                                <?php
                                // 상태에 맞는 버튼들만 출력

                                foreach ($buttonsToShow as $cnfStatus => $label) {

                                    if( $currentStatus != $cnfStatus ){
                                    ?>
                                    <button type="button" class="statusButton" onclick="changeOrderInfoStatusConfirm('<?php echo $cnfStatus; ?>', this)">
                                        <?php echo $label; ?>
                                    </button>
                                    <?php
                                    }
                                }
                                ?>

                            </div>
                            <?php } ?>
                        </div>
                    </div>
                    <?php
                    if (!empty($goodsList)) {
                        foreach ($goodsList as $goods) {
                    ?>
                    <div style="display: flex; justify-content: space-between; padding: 2px 0;" class="goodsWrap" data-ordidx=<?php echo _elm( $goods, 'ordIdx' )?>>
                        <div>
                            <span class="line-thumb"><img src="<?php echo _elm($goods, 'thumb'); ?>" alt="Thumbnail" width=40></span>
                        </div>
                        <div class="in-box">
                            <div class="box-title" style="display: flex; align-items: center;">
                                <div style="flex:6;">
                                    <?php echo _elm($goods, 'title'); ?>
                                </div>
                                <div style="flex:1;">x <?php echo _elm($goods, 'cnt'); ?></div>
                                <div style="flex:2; font-size:14px; font-weight:600;">
                                    <?php echo number_format(_elm($goods, 'orderPrice')); ?> 원
                                </div>
                            </div>

                            <div>
                                <div class="box-option">
                                    <?php echo _elm($goods, 'option'); ?>
                                </div>
                            </div>
                        </div>
                    </div>
                    <?php
                        }
                    }
                    ?>
                </div>
            <?php
                }
            ?>
        </div>
    </td>
    <td class="body2-c small-font" style="vertical-align:top">
        <?php
            $buttonLayer = '';
            $totalPgAmt = 0;
            if( empty( _elm( $vData, 'pgInfo' ) ) === false ){

                $pgInfo  =_elm( $vData, 'pgInfo' );
                $totalPgAmt = _elm( $pgInfo, 'totalPgAmt' );
                if( in_array( 'PayChecking', _elm( $vData, 'status' ) ) || in_array( 'PayRequest', _elm( $vData, 'status' ) ) ||  in_array( 'PayWaiting', _elm( $vData, 'status' ) ) ){
                    $buttonLayer .= '
                        <div  class="payInfo" style="margin-bottom:0.5rem">
                            <div class="box-rows">
                                <div style="text-align: center;font-size:14px;font-weight:600">
                                    입금대기
                                </div>
                                <div style="text-align: right;font-size:14px;font-weight:600">
                                    '.number_format( $totalPgAmt ).' 원
                                </div>
                            </div>
                            <div class="box-rows">
                                <div style="flex:1;text-align: center;font-size:14px;font-weight:600">
                                    <button type="button" class="btn-md" onclick="confirmChangeOrderStatus( \'PayComplete\', \''._elm($vData, 'O_ORDID').'\')" style="width:100%;border-radius: 4px;background: var(-----tblr-secondary, #616876);box-shadow: 0px 1px 0px 0px rgba(29, 39, 59, 0.00) inset, 0px -1px 0px 0px rgba(29, 39, 59, 0.40) inset;">수동입금확인</button>
                                </div>
                            </div>
                            <div class="box-rows">
                                <div style="flex:1;text-align: center;font-size:14px;font-weight:600">
                                    <button type="button" class="btn-md" onclick="confirmChangeOrderStatus( \'PrePayCancelComplate\', \''._elm($vData, 'O_ORDID').'\')" style="width:100%;border-radius: 4px; border: 1px solid var(----tblr-border-color, #E6E7E9);background: var(----tblr-white, #FFF); color: #1D273B ;">입금전 취소</button>
                                </div>
                            </div>
                        </div>
                    ';
                    $totalPgAmt = 0;
                }
                echo $buttonLayer;

            }

        ?>


        <div class="payInfo">
            <?php
            $pgLayer = '';
            $pgInfo = [];

            if( empty( _elm( $vData, 'pgInfo' ) ) === false ){
                $pgInfo  =_elm( $vData, 'pgInfo' );



                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;font-size:14px;font-weight:600">
                            결제금액
                        </div>
                        <div style="text-align: right;font-size:14px;font-weight:600">
                            '.number_format( $totalPgAmt ).' 원
                        </div>
                    </div>
                ';
                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            상품가격
                        </div>
                        <div style="text-align: right;">
                            '.number_format( _elm( $pgInfo, 'totalPrdAmt' ) ).' 원
                        </div>
                    </div>
                ';
                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            사용포인트
                        </div>
                        <div style="text-align: right;">
                            '.( _elm( $pgInfo, 'usePoint' ) > 0 ? ' - ': '' ).number_format( _elm( $pgInfo, 'usePoint' ) ).' 원
                        </div>
                    </div>
                ';

                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            회원 등급할인
                        </div>
                        <div style="text-align: right;">
                            '.( _elm( _elm( $pgInfo, 'priceInfo' ), 'gradeDcAmt' ) > 0 ? ' - ': '' ).number_format( _elm( _elm( $pgInfo, 'priceInfo' ), 'gradeDcAmt' ) ).' 원
                        </div>
                    </div>
                ';
                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            할인
                        </div>
                        <div style="text-align: right;">
                            '.( _elm( _elm( $pgInfo, 'priceInfo' ), 'cpnDcAmt' ) > 0 ? ' - ': '' ).number_format( _elm( _elm( $pgInfo, 'priceInfo' ), 'cpnDcAmt' ) ).' 원
                        </div>
                    </div>
                ';
                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            추가할인
                        </div>
                        <div style="text-align: right;">
                            '.( _elm( _elm( $pgInfo, 'priceInfo' ), 'plusCpnDcAmt' ) > 0 ? ' - ': '' ).number_format( _elm( _elm( $pgInfo, 'priceInfo' ), 'plusCpnDcAmt' ) ).' 원
                        </div>
                    </div>
                ';
                $pgLayer .= '
                    <div class="box-rows">
                        <div style="text-align: left;">
                            결제수단
                        </div>
                        <div style="text-align: right;">
                            '._elm( $pgInfo, 'payMethod' ).'
                        </div>
                    </div>
                ';
                if( _elm( $pgInfo, 'payMethod' ) == '가상계좌' ){
                    $pgLayer .= '
                        <div class="box-rows">
                            <div style="text-align: left;">
                                은행
                            </div>
                            <div style="text-align: right;">
                                '._elm( _elm( $pgInfo, 'virtualBankInfo' ), 'bankNm' ).'
                            </div>
                        </div>
                        <div class="box-rows">
                            <div style="text-align: left;">
                                가상번호
                            </div>
                            <div style="text-align: right;">
                                '._elm( _elm( $pgInfo, 'virtualBankInfo' ), 'accountNum' ).'
                            </div>
                        </div>
                    ';
                }
            }
            if( empty( _elm( $vData, 'claim' ) ) === false ){

                // 결과를 저장할 배열
                $mergedData = [];

                // 배열 순회
                foreach (_elm( $vData, 'claim' ) as $item) {
                    // 중복된 type과 status가 있는지 확인
                    $found = false;

                    // 이미 존재하는 항목을 찾아 금액 합산
                    foreach ($mergedData as &$mergedItem) {
                        if ($mergedItem['type'] === $item['type'] && $mergedItem['status'] === $item['status']) {
                            $mergedItem['resultAmt'] += $item['resultAmt']; // 금액 합산
                            $found = true;
                            break;
                        }
                    }

                    // 중복이 없으면 새로운 항목 추가
                    if (!$found) {
                        $mergedData[] = $item;
                    }
                }


                if( empty( $mergedData ) === false ){
                    foreach( $mergedData as $mKey => $claim ){
                        $title = '';
                        $priceTitle = '';
                        if( _elm( $claim, 'type' ) == 'CANCEL' ){
                            $title = '취소 ';
                            switch( _elm( $claim, 'status' ) ){
                                case 'REQUESTED' :
                                    $title .= '요청';
                                    $priceTitle = '신청금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'PROCESSING' :
                                    $title .= '처리중';
                                    $priceTitle = '예정금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'COMPLETED' :
                                    $title .= '완료';
                                    $priceTitle = '취소금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'REJECTED' :
                                    $title .= '반려';
                                    $priceTitle = '취소금액';
                                    $price = '-';
                                    break;
                                case 'AUTO_COMPLETED' :
                                    $title .= '완료';
                                    $priceTitle = '취소금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                            }
                        }else if( _elm( $claim, 'type' ) == 'RETURN'  ){
                            $title = '환불 ';
                            switch( _elm( $claim, 'status' ) ){
                                case 'REQUESTED' :
                                    $title .= '요청';
                                    $priceTitle = '신청금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'PROCESSING' :
                                    $title .= '처리중';
                                    $priceTitle = '예정금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'COMPLETED' :
                                    $title .= '완료';
                                    $priceTitle = '취소금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                                case 'REJECTED' :
                                    $title .= '반려';
                                    $priceTitle = '취소금액';
                                    $price = '-';
                                    break;
                                case 'AUTO_COMPLETED' :
                                    $title .= '완료';
                                    $priceTitle = '취소금액';
                                    $price = number_format( _elm( $claim, 'resultAmt' ) );
                                    break;
                            }
                        }
                        $pgLayer .= '
                        <div class="box-rows">
                            <div style="text-align: left;font-weight:600">
                                '.$title.'
                            </div>
                            <div style="text-align: right;">
                            </div>
                        </div>
                        <div class="box-rows">
                        <div style="text-align: left;">
                            '.$priceTitle.'
                        </div>
                        <div style="text-align: right;">
                            - '.($price??0).'
                        </div>
                    </div>
                    ';
                    }
                }
            }
            echo $pgLayer;
            ?>

        </div>

    </td>



    <td class="body2-c small-font align-top memo-area"  style="position:relative">


        <div class="box-title memoTitle" style="display: <?php empty( _elm( $vData, 'aMemo') ) === false ? 'flex' : 'none';?> align-items: center;">
            <div style="flex:9;" class="aMemoCnt">
                <?php echo count(_elm( $vData, 'aMemo')) ?>개 메모
            </div>

            <div style="flex:2; font-size:14px; font-weight:600;text-align:right">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" class="dwondownIcon" onclick="openMemoDropDownLayer( this )">
                    <path d="M11 12C11 12.2652 11.1054 12.5196 11.2929 12.7071C11.4804 12.8946 11.7348 13 12 13C12.2652 13 12.5196 12.8946 12.7071 12.7071C12.8946 12.5196 13 12.2652 13 12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M11 19C11 19.2652 11.1054 19.5196 11.2929 19.7071C11.4804 19.8946 11.7348 20 12 20C12.2652 20 12.5196 19.8946 12.7071 19.7071C12.8946 19.5196 13 19.2652 13 19C13 18.7348 12.8946 18.4804 12.7071 18.2929C12.5196 18.1054 12.2652 18 12 18C11.7348 18 11.4804 18.1054 11.2929 18.2929C11.1054 18.4804 11 18.7348 11 19Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M11 5C11 5.26522 11.1054 5.51957 11.2929 5.70711C11.4804 5.89464 11.7348 6 12 6C12.2652 6 12.5196 5.89464 12.7071 5.70711C12.8946 5.51957 13 5.26522 13 5C13 4.73478 12.8946 4.48043 12.7071 4.29289C12.5196 4.10536 12.2652 4 12 4C11.7348 4 11.4804 4.10536 11.2929 4.29289C11.1054 4.48043 11 4.73478 11 5Z" stroke="#616876" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <div class="memo-dropdown" style="display: none;">
                    <button type="button" class="statusButton" onclick="openMemoLayer( '<?php echo _elm($vData, 'O_ORDID')?>' ,this)">
                        메모추가
                    </button>
                    <button type="button" class="statusButton" onclick="">
                        전체 해결
                    </button>
                    <button type="button" class="statusButton" onclick="">
                        전체 삭제
                    </button>
                </div>
            </div>
        </div>

        <div class="memoArea">
    <?php
    if( empty( _elm( $vData, 'aMemo') ) === false ){
        foreach( _elm( $vData, 'aMemo') as $aKey => $aMemo ){
    ?>

        <div class="payInfo memoBox" data-memo-idx="<?php echo _elm( $aMemo, 'M_IDX' )?>">
                <!-- Content -->

            <div class="memo-box-content">

                <div class="flex-box">
                    <span class="flex1">
                        <?php echo _elm($aMemo, 'M_WRITER_NAME'); ?>
                    </span>
                    <div class="toggle-area">
                        <span class="flex-right">
                            <span class="box-radius <?php echo _elm($aMemo, 'M_STATUS') !== 'READY' ? 'active' : ''; ?>">
                            <?php echo _elm($aMemo, 'M_STATUS') == 'READY' ? '미해결' : '해결'; ?>
                            </span>
                        </span>

                        <div class="right-float">
                            <div class="float-item">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" onclick="modifyMemo( this )">
                                    <path d="M7 7.00012H6C5.46957 7.00012 4.96086 7.21084 4.58579 7.58591C4.21071 7.96098 4 8.46969 4 9.00012V18.0001C4 18.5306 4.21071 19.0393 4.58579 19.4143C4.96086 19.7894 5.46957 20.0001 6 20.0001H15C15.5304 20.0001 16.0391 19.7894 16.4142 19.4143C16.7893 19.0393 17 18.5306 17 18.0001V17.0001M16 5.00012L19 8.00012M20.385 6.58511C20.7788 6.19126 21.0001 5.65709 21.0001 5.10011C21.0001 4.54312 20.7788 4.00895 20.385 3.61511C19.9912 3.22126 19.457 3 18.9 3C18.343 3 17.8088 3.22126 17.415 3.61511L9 12.0001V15.0001H12L20.385 6.58511Z" stroke="#6C7A91" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <div class="float-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" onclick="deleteMemoConfirm( this )" >
                                <path d="M4 7H20M10 11V17M14 11V17M5 7L6 19C6 19.5304 6.21071 20.0391 6.58579 20.4142C6.96086 20.7893 7.46957 21 8 21H16C16.5304 21 17.0391 20.7893 17.4142 20.4142C17.7893 20.0391 18 19.5304 18 19L19 7M9 7V4C9 3.73478 9.10536 3.48043 9.29289 3.29289C9.48043 3.10536 9.73478 3 10 3H14C14.2652 3 14.5196 3.10536 14.7071 3.29289C14.8946 3.48043 15 3.73478 15 4V7" stroke="#6C7A91" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            </div>
                            <div class="float-item">

                                <svg class="toggleSvg <?php echo _elm($aMemo, 'M_STATUS') !== 'READY' ? 'active' : ''; ?>"
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <circle class="bg-circle" cx="12" cy="12" r="12" />
                                    <path class="check-path" d="M17 3.33989C18.5083 4.21075 19.7629 5.46042 20.6398 6.96519C21.5167 8.46997 21.9854 10.1777 21.9994 11.9192C22.0135 13.6608 21.5725 15.3758 20.72 16.8946C19.8676 18.4133 18.6332 19.6831 17.1392 20.5782C15.6452 21.4733 13.9434 21.9627 12.2021 21.998C10.4608 22.0332 8.74055 21.6131 7.21155 20.7791C5.68256 19.9452 4.39787 18.7264 3.48467 17.2434C2.57146 15.7604 2.06141 14.0646 2.005 12.3239L2 11.9999L2.005 11.6759C2.061 9.94888 2.56355 8.26585 3.46364 6.79089C4.36373 5.31592 5.63065 4.09934 7.14089 3.25977C8.65113 2.42021 10.3531 1.98629 12.081 2.00033C13.8089 2.01437 15.5036 2.47589 17 3.33989ZM15.707 9.29289C15.5348 9.12072 15.3057 9.01729 15.0627 9.002C14.8197 8.98672 14.5794 9.06064 14.387 9.20989L14.293 9.29289L11 12.5849L9.707 11.2929L9.613 11.2099C9.42058 11.0607 9.18037 10.9869 8.9374 11.0022C8.69444 11.0176 8.46541 11.121 8.29326 11.2932C8.12112 11.4653 8.01768 11.6943 8.00235 11.9373C7.98702 12.1803 8.06086 12.4205 8.21 12.6129L8.293 12.7069L10.293 14.7069L10.387 14.7899C10.5624 14.926 10.778 14.9998 11 14.9998C11.222 14.9998 11.4376 14.926 11.613 14.7899L11.707 14.7069L15.707 10.7069L15.79 10.6129C15.9393 10.4205 16.0132 10.1802 15.9979 9.93721C15.9826 9.69419 15.8792 9.46509 15.707 9.29289Z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="memoContent">
                    <?php echo _elm($aMemo, 'M_CREATE_AT'); ?>
                </div>
                <div>
                    <div><?php echo htmlspecialchars_decode(_elm($aMemo, 'M_CONTENT') );  ?></div>
                </div>

            </div>

        </div>

    <?php
        }
    }else{
    ?>
        <div class="memo-empty">
            <div class="top-right-box">
                <div style="flex:9;">
                    메모 없음
                </div>
                <div style="flex:2; font-size:14px; font-weight:600;text-align:right;">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        width="24" height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        style="cursor: pointer; pointer-events: all;"
                        onclick="openMemoLayer('<?php echo _elm($vData, 'O_ORDID'); ?>', this)">
                    <path d="M7 7.00012H6C5.46957 7.00012 4.96086 7.21084 4.58579 7.58591C4.21071 7.96098 4 8.46969 4 9.00012V18.0001C4 18.5306 4.21071 19.0393 4.58579 19.4143C4.96086 19.7894 5.46957 20.0001 6 20.0001H15C15.5304 20.0001 16.0391 19.7894 16.4142 19.4143C16.7893 19.0393 17 18.5306 17 18.0001V17.0001M16 5.00012L19 8.00012M20.385 6.58511C20.7788 6.19126 21.0001 5.65709 21.0001 5.10011C21.0001 4.54312 20.7788 4.00895 20.385 3.61511C19.9912 3.22126 19.457 3 18.9 3C18.343 3 17.8088 3.22126 17.415 3.61511L9 12.0001V15.0001H12L20.385 6.58511Z"
                            stroke="#6C7A91"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>

                </div>
            </div>
        </div>
    <?php
    }
    ?>
    </div>
    </td>

</tr>
<?php
        }
    }
    else
    {
?>
<tr>
    <td colspan="18">
        "주문 목록이 없습니다."
    </td>
</tr>
<?php
    }
?>